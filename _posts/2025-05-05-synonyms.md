---
title: "Synonyms"
date: 2025-05-05
layout: post
tags: oracle
published: false
---

Setting up a new environment I encounted some unexpected behaviour with regards to Oracle handling of synonyms.  Let me demonstrate the behviour that I encountered first.

```sql
SQL> show user

USER is "PDBADMIN"

SQL> create public synonym t1 for pdbadmin.t1;

Synonym T1 created.

SQL> create public synonym s2 for pdbadmin.t2;

Synonym S2 created.

SQL> select * from dba_synonyms where synonym_name in ('T1', 'S2');

OWNER     SYNONYM_NAME    TABLE_OWNER    TABLE_NAME    DB_LINK       ORIGIN_CON_ID 
_________ _______________ ______________ _____________ __________ ________________ 
PUBLIC    T1              PDBADMIN       T1                                      3 
PUBLIC    S2              PDBADMIN       T2                                      3 

SQL> select * from t1;

SQL Error: ORA-01775: synonym T1 resolves to itself due to circular translation

SQL> select * from s2;

SQL Error: ORA-00980: synonym translation is no longer valid
```

So I have a global synonym called which points to a table called my_table in the pdbadmin. However I have omited to create the actual table pdbamin.my_table.
When I try to reference the table via the public syonym, I get an ora-01775 error, a recursive synonym path.
Of course this can be resolved by properly creating my_table, but let's look further:

```sql
SQL> select * from dba_synonyms where synonym_name = 'MY_TABLE';

OWNER     SYNONYM_NAME    TABLE_OWNER    TABLE_NAME    DB_LINK       ORIGIN_CON_ID 
_________ _______________ ______________ _____________ __________ ________________ 
PUBLIC    MY_TABLE        PDBADMIN       MY_TABLE                                3 

SQL> select * from pdbadmin.my_table;

SQL Error: ORA-00942: table or view "PDBADMIN"."MY_TABLE" does not exist
```

However I've now learned (thanks Neil) that synonym resolution doesn't work that way.

```sql
SQL> create table t as select * from dual;

Table T created.

SQL> create table t as select * from dual;

Table T created.

SQL> create public synonym s1 for pdbadmin.t;

Synonym S1 created.

SQL> create public synonym s2 for pdbadmin.s1;

Synonym S2 created.

SQL> select * from dba_synonyms where synonym_name in ('S1', 'S2');

OWNER     SYNONYM_NAME    TABLE_OWNER    TABLE_NAME    DB_LINK       ORIGIN_CON_ID 
_________ _______________ ______________ _____________ __________ ________________ 
PUBLIC    S1              PDBADMIN       T                                       3 
PUBLIC    S2              PDBADMIN       S1                                      3 

SQL> select * from pdbadmin.s1;

SQL Error: ORA-00942: table or view "PDBADMIN"."S1" does not exist

SQL> select * from s2;

DUMMY    
________ 
X        
```

Even though pdbadmin.s1 doesn't resolve when we reference it directly, when the synonym s1 is being resolved, the database appears to first check if the fully qualified object exists, it allows it to be resolved by the public synyonm.

